#!/bin/sh

#################################
# Simple Program Name Shortening
alias g=git

#############################
# Utilities

# Lock the screen (when going AFK)
alias afk="/System/Library/CoreServices/Menu\ Extras/User.menu/Contents/Resources/CGSession -suspend"

# buzzphrase commit
# used for my presentation decks when I have nothing to say about the commit
alias bpc='git add -A . && git cam "$(buzzphrase 2)" && git push'

# recursive dos2unix in current directory
alias dos2lf='dos2unix `find ./ -type f`'

# Flush the DNS on Mac
alias dnsflush='dscacheutil -flushcache;sudo killall -HUP mDNSResponder'

# Empty the Trash on all mounted volumes and the main HDD.
# Also, clear Appleâ€™s System Logs to improve shell startup speed.
# Finally, clear download history from quarantine. https://mths.be/bum
alias emptytrash="sudo rm -rfv /Volumes/*/.Trashes; sudo rm -rfv ~/.Trash; sudo rm -rfv /private/var/log/asl/*.asl; sqlite3 ~/Library/Preferences/com.apple.LaunchServices.QuarantineEventsV* 'delete from LSQuarantineEvent'"

# Files being opened
alias files.open='sudo fs_usage -e -f filesystem|grep -v CACHE_HIT|grep -v grep|grep open'
# Files used, anywhere on the filesystem
alias files.usage='sudo fs_usage -e -f filesystem|grep -v CACHE_HIT|grep -v grep'
# Files in use in the Users directory
alias files.usage.user='sudo fs_usage -e -f filesystem|grep -v CACHE_HIT|grep -v grep|grep Users'

alias game.seek='txt="";for i in {1..20};do txt=$txt"$i. ";done;txt=$txt" Ready or not, here I come";say $txt'

# Git Tools
# assumes git-up is installed (gem install git-up)
# switches to 'develop' branch, updates all local branches (nicely using git-up), removes all local branches already merged into 'develop'
alias gitdev='git checkout develop; git-up; git branch --merged develop | grep -v "\* develop" | xargs -n 1 git branch -d; git branch;'

# IP addresses
alias ip="dig +short myip.opendns.com @resolver1.opendns.com"
alias iplocal="ipconfig getifaddr en0"
alias ips="ifconfig -a | grep -o 'inet6\? \(addr:\)\?\s\?\(\(\([0-9]\+\.\)\{3\}[0-9]\+\)\|[a-fA-F0-9:]\+\)' | awk '{ sub(/inet6? (addr:)? ?/, \"\"); print }'"

# Show active network interfaces
alias ifactive="ifconfig | pcregrep -M -o '^[^\t:]+:([^\n]|\n\t)*status: active'"

# Show network connections
# Often useful to prefix with SUDO to see more system level network usage
alias network.connections='lsof -l -i +L -R -V'
alias network.established='lsof -l -i +L -R -V | grep ESTABLISHED'
alias network.externalip='curl -s http://checkip.dyndns.org/ | sed "s/[a-zA-Z<>/ :]//g"'
alias network.internalip="ifconfig en0 | egrep -o '([0-9]+\.[0-9]+\.[0-9]+\.[0-9]+)'"

# alias laratail="tail -f $(find /laravel/storage/logs | tail -n 1)"

alias gs="git status"
alias gl="git log"
alias gcom="git checkout master"
alias gaa="git add ."
alias gc="git commit -m "
alias gp="git push"
alias nah="git reset --hard && git clean -df"

alias qq="cat ~/.zsh_history | grep "
alias ww="which "

alias nginx.start='sudo launchctl load /Library/LaunchDaemons/homebrew.mxcl.nginx.plist'
alias nginx.stop='sudo launchctl unload /Library/LaunchDaemons/homebrew.mxcl.nginx.plist'
alias nginx.restart='nginx.stop && nginx.start'
alias nginx.config='sudo $EDITOR /usr/local/etc/nginx/valet/valet.conf'
alias nginx.config='$EDITOR /usr/local/etc/nginx/valet/valet.conf'
alias nginx.configtest='sudo nginx -t'

alias php-fpm.start="sudo launchctl load -w /Library/LaunchDaemons/homebrew.mxcl.php71.plist"
alias php-fpm.stop="sudo launchctl unload -w /Library/LaunchDaemons/homebrew.mxcl.php71.plist"
alias php-fpm.restart='php-fpm.stop && php-fpm.start'

alias mariadb.start="launchctl load -w ~/Library/LaunchAgents/homebrew.mxcl.mariadb.plist"
alias mariadb.stop="launchctl unload -w ~/Library/LaunchAgents/homebrew.mxcl.mariadb.plist"
alias mariadb.logs="tail -250f /tmp/mysql.log"

alias mysql.new='mysql -uroot -e "CREATE DATABASE IF NOT EXISTS $1;"'
alias mysql.rm='mysql -uroot -e "DROP DATABASE IF EXISTS $1;"'

alias mysql.start="launchctl load -w ~/Library/LaunchAgents/homebrew.mxcl.mysql.plist"
alias mysql.stop="launchctl unload -w ~/Library/LaunchAgents/homebrew.mxcl.mysql.plist"
alias mysql.restart='mysql.stop && mysql.start'

# newest log file matching
alias mariadb.logs='tail -250f /var/log/mysql/all.log'
alias ci.logs='tail -250f $(ls -t application/logs/log-* | head -1)'
alias nginx.logs.error='tail -250f /Users/tg/.valet/Log/nginx-error.log'
alias nginx.logs.access='tail -250f /Users/tg/.valet/Log/nginx-access.log'
alias nginx.logs.default.access='tail -250f /usr/local/etc/nginx/logs/default.access.log'
alias nginx.logs.default-ssl.access='tail -250f /usr/local/etc/nginx/logs/default-ssl.access.log'
alias nginx.logs.phpmyadmin.error='tail -250f /usr/local/etc/nginx/logs/phpmyadmin.error.log'
alias nginx.logs.phpmyadmin.access='tail -250f /usr/local/etc/nginx/logs/phpmyadmin.access.log'

alias router='dig | grep "SERVER: "'


# Print each PATH entry on a separate line
alias path='echo -e ${PATH//:/\\n}'

# Copy and paste and prune the usless newline
alias pbcopynn='tr -d "\n" | pbcopy'

# firewall management
alias port-forward-enable="echo 'rdr pass inet proto tcp from any to any port 2376 -> 127.0.0.1 port 2376' | sudo pfctl -ef -"
alias port-forward-disable="sudo pfctl -F all -f /etc/pf.conf"
alias port-forward-list="sudo pfctl -s nat"

# push git repo, but first, use git-up to make sure you are in sync and rebased with the remote
alias pushup="git-up && git push"
# Set the extended MacOS attributes on a file such that Quicklook will open it as text
alias qltext='xattr -wx com.apple.FinderInfo "54 45 58 54 21 52 63 68 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00" $1'
#alias qltext2='osascript -e tell application "Finder" to set file type of ((POSIX file "$1") as alias) to "TEXT"'

# Reload the shell (i.e. invoke as a login shell)
alias reload="exec $SHELL -l"

# Disable Spotlight
alias spotoff="sudo mdutil -a -i off"
# Enable Spotlight
alias spoton="sudo mdutil -a -i on"

# Get macOS Software Updates, and update installed Ruby gems, Homebrew, npm, and their installed packages
alias update='sudo softwareupdate -i -a; brew update; brew upgrade; brew cleanup; mas upgrade; npm install npm -g; npm update -g; sudo gem update --system; sudo gem update; sudo gem cleanup'

alias vtop="vtop --theme wizard"

alias jsonfix="pbpaste | jq . | pbcopy"

alias lookbusy="cat /dev/urandom | hexdump -C | grep \"34 32\""
alias td="todo.sh"
alias tda="todo.sh add"
alias tdl="todo.sh list"
alias tdd="todo.sh do"

git.gitlab.new() {
	gitlab create_project "$1" "{ description: '$2' }" --json
}

git.gitlab.new.init() {
	json=$(git.gitlab.new "$1" "$2" --json)
	http_url_to_repo=$(echo $json | jq .result.http_url_to_repo)
	http_url_to_repo="${http_url_to_repo%\"}"
	http_url_to_repo="${http_url_to_repo#\"}"

	git init
	git remote add origin $http_url_to_repo
	git add .
	git commit -m "Initial commit"
	git push -u origin master
}

alias crack.intellij='dvt-jb_licsrv.darwin.386'
alias pstorm='open -a PhpStorm'
alias pstorm='open -a PhpStorm'
alias ws='open -a Webstorm'
alias ws='open -a Webstorm'

alias pi.magazine="wget -A pdf -m -p -E -k -K -npc https://www.raspberrypi.org/magpi-issues/"
alias pi.findit="dns-sd -G v4 raspberrypi.local"

alias down="aria2c --max-connection-per-server=16 --min-split-size=1M "

alias stress="ab -n 10000 -c 10 "
alias "?"="tldr"

alias curl.download="curl -L -O -C - "

# Reboot my home Linksys WAG160N / WAG54 / WAG320 / WAG120N Router / Gateway from *nix.
alias rebootlinksys="curl -u 'admin:my-super-password' 'http://192.168.1.2/setup.cgi?todo=reboot'"

# Reboot tomato based Asus NT16 wireless bridge
alias reboottomato="ssh admin@192.168.1.1 /sbin/reboot"

alias brew.off="sudo brew services stop --all && brew services stop --all"
alias brew.on="sudo brew services start dnsmasq && \
	brew services start mariadb && \
	sudo brew services start nginx && \
	brew services start redis && \
	sudo brew services start php;"

findc() {
	find $1 -type f -exec grep --color=auto -nH $2 /dev/null {} +
}
alias logfun="tail -f /var/log/nginx/access.log | logstalgia --sync"

alias asd="waitforssh.sh $@"
alias dot="cd ~/.dotfiles"

function node-project {
  git init
  npx license $(npm get init.license) -o "$(npm get init.author.name)" > LICENSE
  npx gitignore node
  npx covgen "$(npm get init.author.email)"
  npm init -y
  git add -A
  git commit -m "Initial commit"
}
alias a.init-npm='node-project'

# A set of aliases to use npx
alias a.create-vue-app="npx vue create ${@:-'my-app'}"
alias a.create-react-app="npx create-react-app ${@:-'my-app'}"
alias a.rm-all-node_modules="find . -name 'node_modules' -exec rm -rf '{}' +"
alias a.sort-package-json="npx sort-package-json $@"
alias a.npm-check="npx npm-check $@"
alias a.npm-check2="npx nsp check $@"
alias a.david="npx david $@"
alias a.nsp="npx nsp ${@:-'check'}"
alias a.nodemon="npx nodemon $@"
alias a.npm-run-all="npx npm-run-all $@"
alias a.webpack="npx webpack-cli $@"
alias a.yo="npx yo $@"

alias s.vue="npx vue/cli $@"
alias s.whereami="npx github:@rafaelrinaldi/whereami $@"
alias s.buzzphrase="npx buzzphrase $@"
alias s.carbon-now="npx carbon-now-cli $@"
alias s.codeceptjs="npx codeceptjs $@"
alias s.empty-trash="npx empty-trash-cli $@"
alias s.filepizza="npx filepizza $@"
alias s.fkill="npx fkill-cli $@"
alias s.get-urls="npx get-urls-cli $@"
alias s.git-open="npx git-open $@"
alias s.gitmoji="npx gitmoji-cli $@"
alias s.gtop="npx gtop $@"
alias s.instant-markdown-d="npx instant-markdown-d $@"
alias s.iponmap="npx iponmap $@"
alias s.kill-tabs="npx kill-tabs $@"
alias s.netlify="npx netlify-cli $@"
alias s.ngrok="npx ngrok $@"
alias s.now="npx now $@"
alias s.npm-check="npx npm-check $@"
alias s.npms="npx npms-cli $@"
alias s.osx-wifi="npx osx-wifi-cli $@"
alias s.pen="npx pen $@"
alias s.prettyaml="npx prettyaml $@"
alias s.prettyjson="npx prettyjson $@"
alias s.puppeteer="npx puppeteer $@"
alias s.redis-commander="npx redis-commander $@"
alias s.shorturl="npx shorturl $@"
alias s.siteaudit="npx siteaudit $@"
alias s.spoof="npx spoof $@"
alias s.surge="npx surge $@"
alias s.torrent="npx torrent $@"
alias s.trash="npx trash-cli $@"
alias s.ungit="npx ungit $@"
alias s.vtop="npx vtop $@"
alias s.vuepress="npx vuepress $@"
alias s.wallpaper="npx wallpaper-cli $@"
alias s.why-is-node-running="npx why-is-node-running $@"
alias s.wifi-password="npx wifi-password-cli $@"
alias s.yamlxjson="npx yamlxjson $@"

alias d.qrcode='npx qrip $@'
alias d.workin-hard='npx workin-hard $@'

alias l.prettier="npx prettier $@"
alias l.eslint="npx eslint $@"
alias l.babel-eslint="npx babel-eslint $@"
alias l.eslint-config-standard="npx eslint-config-standard $@"
alias l.eslint-config-standard-react="npx eslint-config-standard-react $@"
alias l.eslint-config-standard-jsx="npx eslint-config-standard-jsx $@"
alias l.eslint-plugin-react="npx eslint-plugin-react $@"
alias l.eslint-config-prettier="npx eslint-config-prettier $@"
alias l.eslint-plugin-prettier="npx eslint-plugin-prettier $@"


# A full set of cowsay aliases (includes all default cowsay options)
alias pet.cow='npx cowsay $@'
alias pet.turtle='npx cowsay $@ -f turtle'
alias pet.beavis='npx cowsay $@ -f beavis.zen'
alias pet.bong='npx cowsay $@ -f bong'
alias pet.bud-frogs='npx cowsay $@ -f bud-frogs'
alias pet.bunny='npx cowsay $@ -f bunny'
alias pet.cheese='npx cowsay $@ -f cheese'
alias pet.cower='npx cowsay $@ -f cower'
alias pet.daemon='npx cowsay $@ -f daemon'
alias pet.doge='npx cowsay $@ -f doge'
alias pet.dragon-and-cow='npx cowsay $@ -f dragon-and-cow'
alias pet.dragon='npx cowsay $@ -f dragon'
alias pet.elephant-in-snake='npx cowsay $@ -f elephant-in-snake'
alias pet.elephant='npx cowsay $@ -f elephant'
alias pet.eyes='npx cowsay $@ -f eyes'
alias pet.flaming-sheep='npx cowsay $@ -f flaming-sheep'
alias pet.ghostbusters='npx cowsay $@ -f ghostbusters'
alias pet.goat='npx cowsay $@ -f goat'
alias pet.head-in='npx cowsay $@ -f head-in'
alias pet.hedgehog='npx cowsay $@ -f hedgehog'
alias pet.hellokitty='npx cowsay $@ -f hellokitty'
alias pet.kiss='npx cowsay $@ -f kiss'
alias pet.kitty='npx cowsay $@ -f kitty'
alias pet.koala='npx cowsay $@ -f koala'
alias pet.kosh='npx cowsay $@ -f kosh'
alias pet.luke-koala='npx cowsay $@ -f luke-koala'
alias pet.mech-and-cow='npx cowsay $@ -f mech-and-cow'
alias pet.meow='npx cowsay $@ -f meow'
alias pet.milk='npx cowsay $@ -f milk'
alias pet.moofasa='npx cowsay $@ -f moofasa'
alias pet.moose='npx cowsay $@ -f moose'
alias pet.mutilated='npx cowsay $@ -f mutilated'
alias pet.ren='npx cowsay $@ -f ren'
alias pet.satanic='npx cowsay $@ -f satanic'
alias pet.sheep='npx cowsay $@ -f sheep'
alias pet.skeleton='npx cowsay $@ -f skeleton' 
alias pet.small='npx cowsay $@ -f small'
alias pet.sodomized='npx cowsay $@ -f sodomized'
alias pet.squirrel='npx cowsay $@ -f squirrel'
alias pet.stegosaurus='npx cowsay $@ -f stegosaurus'
alias pet.stimpy='npx cowsay $@ -f stimpy'
alias pet.supermilker='npx cowsay $@ -f supermilker'
alias pet.surgery='npx cowsay $@ -f surgery'
alias pet.telebears='npx cowsay $@ -f telebears'
alias pet.turkey='npx cowsay $@ -f turkey'
alias pet.turtle='npx cowsay $@ -f turtle'
alias pet.tux='npx cowsay $@ -f tux'
alias pet.vader-koala='npx cowsay $@ -f vader-koala'
alias pet.vader='npx cowsay $@ -f vader'
alias pet.whale='npx cowsay $@ -f whale'
alias pet.www='npx cowsay $@ -f www'